openapi: "3.0.0"

info:
  title: API specs for Task
  description:
    Task API paths and entity is defined in this file.
  version: "1.0.2"

servers:
  - url: ""

tags:
  - name: Task
    description: APIs required for Summons related to a Case

paths:
  /task/v1/create:
    post:
      tags:
        - Task
      summary: create a new Task
      requestBody:
        description: details for the creation of task
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/TaskRequest'
      responses:
        "201":
          description: ResponseInfo with task created successfully
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/TaskResponse'
        "400":
          description: Task(s) update failed
          content:
            '*/*':
              schema:
                $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes'
      x-codegen-request-body-name: taskRequest

  /task/v1/update:
    post:
      tags:
        - Task
      summary: update a Task
      requestBody:
        description: details for the update of task
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/TaskRequest'
      responses:
        "200":
          description: ResponseInfo with summons updated successfully
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/TaskResponse'
        "400":
          description: task(s) update failed
          content:
            '*/*':
              schema:
                $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes'
      x-codegen-request-body-name: taskRequest

  /task/v1/search:
    post:
      tags:
        - Task
      summary: search for task(s)
      description: |
        search task(s) based on different parameters
      parameters:
        - name: id
          in: query
          description: id of the task(s) whose status is being updated
          schema:
            type: string
        - name: tenantId
          in: query
          description: tenantId whose task(servers) are being searched
          schema:
            type: string
        - name: orderId
          in: query
          description: the order ID whose task(s) are being queried
          required: true
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          description: the status of the task(s) being searched
          schema:
            type: string
      responses:
        "200":
          description: ResponseInfo with list of task(s)
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/TaskListResponse'
        "400":
          description: status update
          content:
            '*/*':
              schema:
                $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes'

  /task/v1/exists/{Id}:
    get:
      tags:
        - Task
      summary: check if task exists
      operationId: getIfTaskExists
      parameters:
        - name: Id
          in: path
          description: the ID of the task
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: true if exists, else false
          content:
            text/plain:
              schema:
                type: boolean
                description: true if exists, else false
        "400":
          description: failed to find task
          content:
            '*/*':
              schema:
                $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes'

components:
  schemas:
    TaskRequest:
      type: object
      properties:
        orderId:
          type: string
          format: uuid
          minLength: 36
          maxLength: 36
          description: ID of the order, this task is associated with
        requestInfo:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/RequestInfo'
        task:
          $ref: '#/components/schemas/Task'
    TaskResponse:
      type: object
      properties:
        responseInfo:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ResponseInfo'
        task:
          $ref: '#/components/schemas/Task'

    TaskListResponse:
      type: object
      properties:
        responseInfo:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ResponseInfo'
        orderID:
          type: string
          format: uuid
        TotalCount:
          type: integer
        list:
          type: array
          items:
            $ref: '#/components/schemas/Task'

    Task:
      description: A task is created as part of an Order. It will always be linked to an order
      type: object
      properties:
        id:
          type: string
          format: uuid
          minLength: 36
          maxLength: 36
          description: auto generated primary for internal reference
          readOnly: true
        tenantId:
          type: string
          description: This is tenantId of the case
        orderId:
          type: string
          format: uuid
          minLength: 36
          maxLength: 36
          description: the associated order
        caseId:
          type: string
          format: uuid
          minLength: 36
          maxLength: 36
          description: the associated case
        createdDate:
          type: string
          format: date
          description: the date on which the task was created. Can be treated as the start date also
        dateCloseBy:
          type: string
          format: date
          description: the date by which the task needs to be closed
        dateClosed:
          type: string
          format: date
          nullable: true
          description: the date on which the task was actually closed
        taskDescription:
          type: string
          description: details of the specific task to be done
        taskType:
          type: string
          description: there will be various types of tasks, that will define their own schema for information required. This type will help identify what schema to pick from MDMS
          example: document submission, summons, bail.cash, bail.surety warrant
        specialFields:
          type: string
          description: TODO this needs to change to be able to accommodate the specific schema based on if it is summon, bail, warrant or something else

        amount:
          $ref: '#/components/schemas/Amount'
          
        status:
          type: string
          description: workflow status
        person:
          type: object
          description: details of person this task is assigned to. For example in case of document upload, this could be litigant or lawyer. in case of summon task, this will be person to whom summon is issued
          properties:
            id:
              type: string
              format: uuid
              minLength: 36
              maxLength: 36
              description: ID of the person if the person is in the system, in which case the name field can be left blank
            name:
              type: string
              description: name of the person if not in the system 
        deliveryChannel:
          type: string
          description: if task has a delivery channel associated with it, then this will point to it via Master data
          example: ePost, NSTEP, iCoPs
        isActive:
          type: boolean
          description: to handle soft delete
        documents:
          type: array
          description: documents related to the task, for example the summon PDF when issuing summon and also the evidence that summon was delivered
          items:
            $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/Document'
        additionalDetails:
          type: string
          description: This field is meant to hold any extra information that we want to store.
        auditDetails:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/AuditDetails'
        workflow:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/Workflow'

    Amount:
      type: object
      description: amount in form of fees or penalty
      properties:
        createdDate:
          type: integer
        dueDate:
          type: integer
          description: This field holds information about due date of fine.
        closedDate:
          type: string
          format: date
          description: the date when the amount was finally paid or refunded
        amount:
          type: string
          description: This field holds information about amount to be paid
        type:
          type: string
          example: fees, fine, refund
        status:
          type: string
          description: status of payment